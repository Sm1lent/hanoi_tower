var T=Object.defineProperty;var I=(t,e,o)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var l=(t,e,o)=>I(t,typeof e!="symbol"?e+"":e,o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();class y{constructor(e,o,s){l(this,"id");l(this,"color");l(this,"size");this.id=o,this.color=e,this.size=s}}class u{constructor(e){l(this,"towerNumber");l(this,"stack",[]);l(this,"element");l(this,"fullHeight");const{towerNumber:o,element:s,startNumber:r,isStartTower:n}=e;if(n)for(let c=0;c<r;c++){const k=new y(E(),c,r-c);this.stack.push(k)}this.towerNumber=o,this.element=s,this.fullHeight=r}addItem(e){this.stack.push(e),this.redrawTower()}popTopItem(){const e=this.stack.pop();return this.redrawTower(),e}reportTowerStack(){console.log(this.stack)}getStackLength(){return this.stack.length}redrawTower(){this.element.innerHTML="";for(let e of this.stack){const{color:o,size:s,id:r}=e,n=document.createElement("div");n.classList.add("brick"),n.style.width=`${s*20+20}px`,n.style.backgroundColor=o,n.innerText=(r+1).toString(),this.element.append(n)}}isEmpty(){return this.stack.length===0}isFull(){return this.stack.length===this.fullHeight}lookAtTop(){return this.stack[this.stack.length-1]}reportStack(){console.log(this.stack)}}function E(){return`rgb(${Math.floor(Math.random()*255)},${Math.floor(Math.random()*255)},${Math.floor(Math.random()*255)})`}console.log("Игра началась");const N=document.getElementById("tower1"),S=document.getElementById("tower2"),L=document.getElementById("tower3"),v=document.getElementById("moves-count"),m=document.getElementById("gameover"),a=document.getElementById("form"),g=document.getElementById("start-number"),p=document.getElementById("tick"),d=document.getElementById("stop"),i={moves:0,startNumber:8,tick:100,isRunning:!1,switchStatus(t){this.isRunning=t},isStartNumberEven(){return this.startNumber%2===0},start(){m.classList.remove("visible"),this.isRunning=!0,this.moves=0,w(this.startNumber)},break(){h("Игра прервана")},end(){h("Башня перестроена. Спасибо за внимание (:")}};a.addEventListener("submit",t=>{t.preventDefault(),i.startNumber=Number(g.value)>2?Number(g.value):3,i.tick=Number(p.value)>=0?Number(p.value):0,a.classList.add("hidden"),d.classList.remove("hidden"),i.start()});d.addEventListener("click",()=>{i.break()});function w(t){const e=new u({towerNumber:1,element:N,startNumber:t,isStartTower:!0}),o=new u({towerNumber:2,element:S,startNumber:t}),s=new u({towerNumber:3,element:L,startNumber:t});console.log("first:",e,"second:",o,"third:",s),f(e,o,s),b(e,o,s)}function b(t,e,o){F(t,e,o),setTimeout(()=>{e.isFull()?i.end():i.isRunning?(R(t,e,o),setTimeout(()=>{b(t,e,o)},i.tick)):i.break()},i.tick)}function f(t,e,o){console.log("Стек первой башни:"),t.reportStack(),console.log("Стек второй башни:"),e.reportStack(),console.log("Стек третей башни:"),o.reportStack()}function M(t,e){i.moves++;const o=t.popTopItem();o&&(e.addItem(o),v.innerText=i.moves.toString())}function A(t,e){i.moves++;const o=t.popTopItem();o&&e.addItem(o),v.innerText=i.moves.toString()}function B(t,e){var r,n;if(t.isEmpty())return{sourceTower:e,targetTower:t};if(e.isEmpty())return{sourceTower:t,targetTower:e};const[o,s]=[(r=t.lookAtTop())==null?void 0:r.size,(n=e.lookAtTop())==null?void 0:n.size];if(o&&s)return o>s?{sourceTower:e,targetTower:t}:{sourceTower:t,targetTower:e}}function z(t,e,o){const s=[t,e,o].find(n=>{var c;return((c=n.lookAtTop())==null?void 0:c.size)===1}),r=s==null?void 0:s.towerNumber;return i.isStartNumberEven()?{towerWithTopper:s,targetForTopper:r===1?o:r===2?t:e}:{towerWithTopper:s,targetForTopper:r===2?o:r===3?t:e}}function F(t,e,o){const{towerWithTopper:s,targetForTopper:r}=z(t,e,o);console.log("tower-top",s==null?void 0:s.towerNumber,"tower-to",r==null?void 0:r.towerNumber),s&&r&&M(s,r),f(t,e,o)}function R(t,e,o){const s=[t,e,o].filter(r=>{var n;return((n=r.lookAtTop())==null?void 0:n.size)!==1});if(s.length===2){const r=B(s[0],s[1]);if(r){const{sourceTower:n,targetTower:c}=r;A(n,c)}f(t,e,o)}}function h(t){i.isRunning=!1,console.log(t),m.classList.add("visible"),m.innerText=t,a.classList.remove("hidden"),d.classList.add("hidden")}
